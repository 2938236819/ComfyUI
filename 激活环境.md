# 进入 ComfyUI 目录（如果你还没进）
cd ~/ComfyUI

# 创建虚拟环境（名字叫 .venv，隐藏文件夹）
python3 -m venv .venv

# 激活虚拟环境
source .venv/bin/activate

# 升级 pip（可选但推荐）
pip install --upgrade pip

# 安装支持 M4 GPU 的 PyTorch（自动启用 Metal 加速）
pip install torch torchvision torchaudio

# 安装 ComfyUI 其他依赖
pip install -r requirements.txt




# 删除旧的虚拟环境（.venv）
rm -rf .venv

# 删除可能残留的插件缓存（可选但推荐）
rm -rf custom_nodes/__pycache__
rm -rf custom_nodes/comfy_api_nodes/__pycache__

# 创建新的虚拟环境
python3 -m venv .venv

# 激活虚拟环境
source .venv/bin/activate

# 升级 pip（避免老版本问题）
pip install --upgrade pip

# 安装 ComfyUI 官方依赖
pip install -r requirements.txt